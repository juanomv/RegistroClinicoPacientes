{"ast":null,"code":"import _regeneratorRuntime from\"/home/juano/reactProjects/qr_guillo/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/juano/reactProjects/qr_guillo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/juano/reactProjects/qr_guillo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import app,{db}from\"../firebase.config\";import{getAuth,signOut}from\"firebase/auth\";import{collection,getDocs,query,doc,addDoc,deleteDoc,updateDoc}from\"firebase/firestore\";import{getStorage,ref,uploadBytes,getDownloadURL}from\"firebase/storage\";import QRImage from\"react-qr-image\";import Modal from\"./Modal\";import QrButon from\"./QrButon\";import DeleteButon from\"./DeleteButon\";import logo from'../assets/img/logo.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var auth=getAuth(app);var storage=getStorage(app);var Main=function Main(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modal=_useState2[0],setmodal=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),modalQr=_useState4[0],setmodalQr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),ModalUpdate=_useState6[0],setmodalUpdate=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),Documentos=_useState8[0],setDocumentos=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),rerender=_useState10[0],setrerender=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),urlDescarga=_useState12[0],seturlDescarga=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),message=_useState14[0],setmessage=_useState14[1];function obtenerDocumentos(){return _obtenerDocumentos.apply(this,arguments);}function _obtenerDocumentos(){_obtenerDocumentos=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var result;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return getDocs(query(collection(db,\"Documento\")));case 2:result=_context5.sent;return _context5.abrupt(\"return\",result);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return _obtenerDocumentos.apply(this,arguments);}var subir=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var titulo,pacinete,today,dd,mm,yyyy,jsondata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(\"url: \"+urlDescarga);if(urlDescarga){titulo=e.target.Titulo.value;pacinete=e.target.Paciente.value;today=new Date();dd=today.getDate();mm=today.getMonth()+1;//January is 0!\nyyyy=today.getFullYear();if(dd<10){dd=\"0\"+dd;}if(mm<10){mm=\"0\"+mm;}today=dd+\"/\"+mm+\"/\"+yyyy;jsondata={Titulo:titulo,Paciente:pacinete,fecha:today,url:urlDescarga};addDoc(collection(db,\"Documento\"),JSON.parse(JSON.stringify(jsondata)));setmodal(!modal);seturlDescarga(null);setmessage(null);setrerender(!rerender);}else{setmessage(\"Cargando el documento intente de nuevo\");}case 3:case\"end\":return _context.stop();}}},_callee);}));return function subir(_x){return _ref.apply(this,arguments);};}();var update=function update(id){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var titulo,pacinete,today,dd,mm,yyyy,jsondata,documeref;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();console.log(\"url: \"+urlDescarga);titulo=e.target.Titulo.value;pacinete=e.target.Paciente.value;today=new Date();dd=today.getDate();mm=today.getMonth()+1;//January is 0!\nyyyy=today.getFullYear();if(dd<10){dd=\"0\"+dd;}if(mm<10){mm=\"0\"+mm;}today=mm+\"/\"+dd+\"/\"+yyyy;jsondata={Titulo:titulo,Paciente:pacinete,fecha:today,url:ModalUpdate.url};// console.log(collection(db, `Documento/${id}`));\n//console.log(id)\ndocumeref=doc(db,\"Documento/\".concat(id));//console.log(documeref);\nupdateDoc(documeref,JSON.parse(JSON.stringify(jsondata)));setmodalUpdate(!modal);seturlDescarga(null);setmessage(null);case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var fileHandel=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var pdf,minuto,seconds,sec,archivo;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:pdf=e.target.files[0];minuto=new Date().getMinutes();seconds=new Date().getMilliseconds();sec=new Date().getSeconds();archivo=ref(storage,\"documentos/\".concat(pdf.name,\"-\").concat(seconds,\"-\").concat(minuto,\"-\").concat(sec));_context3.next=7;return uploadBytes(archivo,pdf);case 7:_context3.t0=seturlDescarga;_context3.next=10;return getDownloadURL(archivo);case 10:_context3.t1=_context3.sent;(0,_context3.t0)(_context3.t1);case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function fileHandel(_x3){return _ref3.apply(this,arguments);};}();function QRmodal(url){setmodalQr(url);}function eliminar(_x4){return _eliminar.apply(this,arguments);}function _eliminar(){_eliminar=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return deleteDoc(doc(db,\"Documento\",id));case 2:setrerender(!rerender);case 3:case\"end\":return _context6.stop();}}},_callee6);}));return _eliminar.apply(this,arguments);}useEffect(function(){var Obtenerdatos=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return obtenerDocumentos();case 2:data=_context4.sent;setDocumentos(data.docs);console.log('peticion');case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function Obtenerdatos(){return _ref4.apply(this,arguments);};}();Obtenerdatos();},[rerender]);//{new Date(time.toDate()).toDateString()}\n//let date = new Date(Documentos[0].data().fecha)\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\" sm:w-auto flex flex-row justify-between px-10 bg-blue-primary p-3 text-xl uppercase\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-28 bg-white\",src:logo,alt:\"\"}),/*#__PURE__*/_jsx(\"button\",{className:\"uppercase text-green-primary  hover:text-white \",onClick:function onClick(){return signOut(auth);},children:\"cerrar sesion\"})]}),modal&&/*#__PURE__*/_jsx(Modal,{titulo:\"Subir Documento\",cerrar:function cerrar(){return setmodal(!modal);},children:/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:subir,className:\"flex flex-col\",children:[message&&/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-700\",children:message}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Titulo\",children:\"Titulo:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"p-2 border-b border-blue-primary mb-2\",type:\"text\",autoFocus:true,required:true,placeholder:\"Ingrese Un Titulo\",id:\"Titulo\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Paciente\",children:\"Nombre del Paciente\"}),/*#__PURE__*/_jsx(\"input\",{className:\"p-2 border-b border-blue-primary mb-2\",type:\"text\",placeholder:\"Ingrese Nombre del Paciente\",maxLength:\"200\",id:\"Paciente\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"document\",children:\"Subir Document\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",label:\"Upload\",name:\"pdf\",id:\"document\",multiple:false,accept:\"application/pdf\",required:true,onChange:fileHandel}),/*#__PURE__*/_jsx(\"input\",{className:\"mx-auto mt-10 w-2/3 bg-blue-primary text-white rounded-md hover:bg-green-primary\",type:\"submit\",value:\"Subir\"})]})})}),modalQr&&/*#__PURE__*/_jsx(Modal,{titulo:\"QR\",cerrar:function cerrar(){return setmodalQr(null);},children:/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",id:\"qr\",children:/*#__PURE__*/_jsx(QRImage,{children:modalQr})})}),ModalUpdate&&/*#__PURE__*/_jsx(Modal,{titulo:\"Editar Documento\",cerrar:function cerrar(){return setmodalUpdate(false);},children:/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:update(\"\"),className:\"flex flex-col\",children:[message&&/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-700\",children:message}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Titulo\",children:\"Titulo:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"p-2 border-b border-blue-primary mb-2\",type:\"text\",autoFocus:true,required:true,placeholder:\"Ingrese Un Titulo\",id:\"Titulo\",defaultValue:ModalUpdate.Titulo}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Paciente\",children:\"Nombre del Paciente\"}),/*#__PURE__*/_jsx(\"input\",{className:\"p-2 border-b border-blue-primary mb-2\",type:\"text\",placeholder:\"Ingrese Nombre del Paciente\",maxLength:\"200\",id:\"Paciente\",defaultValue:ModalUpdate.Paciente}),/*#__PURE__*/_jsx(\"input\",{className:\"mx-auto mt-10 w-2/3 bg-blue-primary text-white rounded-md hover:bg-green-primary\",type:\"submit\",value:\"Subir\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-300 h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-stretch  \",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return setmodal(!modal);},className:\"flex flex-row justify-evenly text-white rounded-md bg-blue-500 w-52 p-4 text-2xl font-bold ml-24 mb-14 mt-10\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Nuevo\"}),/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-8 w-8 text-white\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 4v16m8-8H4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\" container m-auto \",children:/*#__PURE__*/_jsxs(\"table\",{className:\"m-auto bg-white\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"  bg-blue-primary h-5 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\" hidden sm:block \",children:\"Titulo\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-2/12 sm:w-4/12\",children:\"Nombre Del Paciente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-1/12 sm:w-1/12\",children:\"Fecha\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-1/12 sm:w-1/12\",children:\"pdf\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-1/12 sm:w-1/12\",children:\"Eliminar\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-1/12 sm:w-1/12\",children:\"Qr\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"text-center \",children:Documentos.length>0?Documentos.map(function(element){return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b  border-blue-primary\",children:[/*#__PURE__*/_jsx(\"td\",{className:\" hidden sm:block \",children:/*#__PURE__*/_jsx(\"a\",{href:element.data().url,target:\"_blank\",rel:\"noopener noreferrer\",children:element.data().Titulo})}),/*#__PURE__*/_jsx(\"td\",{children:element.data().Paciente}),/*#__PURE__*/_jsx(\"td\",{children:element.data().fecha}),/*#__PURE__*/_jsx(\"td\",{className:\"hover:bg-blue-primary hover:text-white\",children:/*#__PURE__*/_jsx(\"a\",{className:\"flex flex-row m-auto\",href:element.data().url,target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-8 w-8 m-auto\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})})})}),/*#__PURE__*/_jsx(\"td\",{className:\"hover:bg-blue-primary hover:text-white\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return eliminar(element.id);},children:/*#__PURE__*/_jsx(DeleteButon,{})})}),/*#__PURE__*/_jsx(\"td\",{className:\"hover:bg-blue-primary hover:text-white\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return QRmodal(element.data().url);},children:/*#__PURE__*/_jsx(QrButon,{})})})]});}):/*#__PURE__*/_jsx(\"div\",{children:\"Sin documentos \"})})]})})]})})]});};export default Main;","map":{"version":3,"sources":["/home/juano/reactProjects/qr_guillo/src/componets/Main.jsx"],"names":["React","useState","useEffect","app","db","getAuth","signOut","collection","getDocs","query","doc","addDoc","deleteDoc","updateDoc","getStorage","ref","uploadBytes","getDownloadURL","QRImage","Modal","QrButon","DeleteButon","logo","auth","storage","Main","modal","setmodal","modalQr","setmodalQr","ModalUpdate","setmodalUpdate","Documentos","setDocumentos","rerender","setrerender","urlDescarga","seturlDescarga","message","setmessage","obtenerDocumentos","result","subir","e","preventDefault","console","log","titulo","target","Titulo","value","pacinete","Paciente","today","Date","dd","getDate","mm","getMonth","yyyy","getFullYear","jsondata","fecha","url","JSON","parse","stringify","update","id","documeref","fileHandel","pdf","files","minuto","getMinutes","seconds","getMilliseconds","sec","getSeconds","archivo","name","QRmodal","eliminar","Obtenerdatos","data","docs","length","map","element"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport app, { db } from \"../firebase.config\";\nimport { getAuth, signOut } from \"firebase/auth\";\nimport {\n  collection,\n  getDocs,\n  query,\n  doc,\n  addDoc,\n  deleteDoc,\n  updateDoc,\n} from \"firebase/firestore\";\nimport { getStorage, ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport QRImage from \"react-qr-image\";\nimport Modal from \"./Modal\";\nimport QrButon from \"./QrButon\";\nimport DeleteButon from \"./DeleteButon\";\nimport logo from '../assets/img/logo.png';\n\nconst auth = getAuth(app);\nconst storage = getStorage(app);\nconst Main = () => {\n  const [modal, setmodal] = useState(false);\n  const [modalQr, setmodalQr] = useState(null);\n  const [ModalUpdate, setmodalUpdate] = useState(false);\n  const [Documentos, setDocumentos] = useState([]);\n  const [rerender, setrerender] = useState(false);\n  const [urlDescarga, seturlDescarga] = useState(null);\n  const [message, setmessage] = useState(null);\n  async function obtenerDocumentos() {\n    const result = await getDocs(query(collection(db, \"Documento\")));\n    return result;\n  }\n  const subir = async (e) => {\n    e.preventDefault();\n    console.log(\"url: \" + urlDescarga);\n    if (urlDescarga) {\n      const titulo = e.target.Titulo.value;\n      const pacinete = e.target.Paciente.value;\n      let today = new Date();\n      let dd = today.getDate();\n      let mm = today.getMonth() + 1; //January is 0!\n      let yyyy = today.getFullYear();\n\n      if (dd < 10) {\n        dd = \"0\" + dd;\n      }\n\n      if (mm < 10) {\n        mm = \"0\" + mm;\n      }\n      today = dd + \"/\" + mm + \"/\" + yyyy;\n      const jsondata = {\n        Titulo: titulo,\n        Paciente: pacinete,\n        fecha: today,\n        url: urlDescarga,\n      };\n      addDoc(collection(db, \"Documento\"), JSON.parse(JSON.stringify(jsondata)));\n      setmodal(!modal);\n      seturlDescarga(null);\n      setmessage(null);\n      setrerender(!rerender);\n    } else {\n      setmessage(\"Cargando el documento intente de nuevo\");\n    }\n  };\n\n  const update = (id) => async (e) => {\n    e.preventDefault();\n    console.log(\"url: \" + urlDescarga);\n\n    const titulo = e.target.Titulo.value;\n    const pacinete = e.target.Paciente.value;\n    let today = new Date();\n    let dd = today.getDate();\n    let mm = today.getMonth() + 1; //January is 0!\n    let yyyy = today.getFullYear();\n\n    if (dd < 10) {\n      dd = \"0\" + dd;\n    }\n\n    if (mm < 10) {\n      mm = \"0\" + mm;\n    }\n    today = mm + \"/\" + dd + \"/\" + yyyy;\n    const jsondata = {\n      Titulo: titulo,\n      Paciente: pacinete,\n      fecha: today,\n      url: ModalUpdate.url,\n    };\n    // console.log(collection(db, `Documento/${id}`));\n    //console.log(id)\n    const documeref = doc(db, `Documento/${id}`);\n    //console.log(documeref);\n    updateDoc(documeref, JSON.parse(JSON.stringify(jsondata)));\n\n    setmodalUpdate(!modal);\n    seturlDescarga(null);\n    setmessage(null);\n  };\n\n\n  const fileHandel = async (e) => {\n    const pdf = e.target.files[0];\n    const minuto = new Date().getMinutes();\n    const seconds = new Date().getMilliseconds();\n    const sec = new Date().getSeconds();\n    const archivo = ref(\n      storage,\n      `documentos/${pdf.name}-${seconds}-${minuto}-${sec}`\n    );\n    await uploadBytes(archivo, pdf);\n    seturlDescarga(await getDownloadURL(archivo));\n  };\n  function QRmodal(url) {\n    setmodalQr(url);\n  }\n  async function eliminar(id) {\n    await deleteDoc(doc(db, \"Documento\", id));\n    setrerender(!rerender);\n  }\n\n  useEffect(() => {\n    const Obtenerdatos = async () => {\n      const data = await obtenerDocumentos();\n\n      setDocumentos(data.docs);\n      console.log('peticion')\n    };\n    Obtenerdatos();\n  }, [rerender]);\n  //{new Date(time.toDate()).toDateString()}\n  //let date = new Date(Documentos[0].data().fecha)\n\n  return (\n    <div className=\"\">\n      <div className=\" sm:w-auto flex flex-row justify-between px-10 bg-blue-primary p-3 text-xl uppercase\">\n        <img className=\"w-28 bg-white\" src={logo} alt=\"\" />\n        <button\n          className=\"uppercase text-green-primary  hover:text-white \"\n          onClick={() => signOut(auth)}\n        >\n          cerrar sesion\n        </button>\n      </div>\n      {modal && (\n        <Modal titulo={\"Subir Documento\"} cerrar={() => setmodal(!modal)}>\n          <div className=\"p-8\">\n            <form onSubmit={subir} className=\"flex flex-col\">\n              {message && <span className=\"text-yellow-700\">{message}</span>}\n              <label htmlFor=\"Titulo\">Titulo:</label>\n              <input\n                className=\"p-2 border-b border-blue-primary mb-2\"\n                type=\"text\"\n                autoFocus\n                required\n                placeholder=\"Ingrese Un Titulo\"\n                id=\"Titulo\"\n              />\n              <label htmlFor=\"Paciente\">Nombre del Paciente</label>\n              <input\n                className=\"p-2 border-b border-blue-primary mb-2\"\n                type=\"text\"\n                placeholder=\"Ingrese Nombre del Paciente\"\n                maxLength=\"200\"\n                id=\"Paciente\"\n              />\n              <label htmlFor=\"document\">Subir Document</label>\n              <input\n                type=\"file\"\n                label=\"Upload\"\n                name=\"pdf\"\n                id=\"document\"\n                multiple={false}\n                accept=\"application/pdf\"\n                required\n                onChange={fileHandel}\n              />\n\n              <input\n                className=\"mx-auto mt-10 w-2/3 bg-blue-primary text-white rounded-md hover:bg-green-primary\"\n                type=\"submit\"\n                value=\"Subir\"\n              />\n            </form>\n          </div>\n        </Modal>\n      )}\n      {modalQr && (\n        <Modal titulo={\"QR\"} cerrar={() => setmodalQr(null)}>\n          <div className=\"p-8\" id=\"qr\">\n            <QRImage>{modalQr}</QRImage>\n          </div>\n        </Modal>\n      )}\n      {ModalUpdate && (\n        <Modal titulo={\"Editar Documento\"} cerrar={() => setmodalUpdate(false)}>\n          <div className=\"p-8\">\n            <form onSubmit={update(\"\")} className=\"flex flex-col\">\n              {message && <span className=\"text-yellow-700\">{message}</span>}\n              <label htmlFor=\"Titulo\">Titulo:</label>\n              <input\n                className=\"p-2 border-b border-blue-primary mb-2\"\n                type=\"text\"\n                autoFocus\n                required\n                placeholder=\"Ingrese Un Titulo\"\n                id=\"Titulo\"\n                defaultValue={ModalUpdate.Titulo}\n              />\n              <label htmlFor=\"Paciente\">Nombre del Paciente</label>\n              <input\n                className=\"p-2 border-b border-blue-primary mb-2\"\n                type=\"text\"\n                placeholder=\"Ingrese Nombre del Paciente\"\n                maxLength=\"200\"\n                id=\"Paciente\"\n                defaultValue={ModalUpdate.Paciente}\n              />\n              <input\n                className=\"mx-auto mt-10 w-2/3 bg-blue-primary text-white rounded-md hover:bg-green-primary\"\n                type=\"submit\"\n                value=\"Subir\"\n              />\n            </form>\n          </div>\n        </Modal>\n      )}\n      <div className=\"bg-gray-300 h-screen\">\n        <div className=\"flex flex-col items-stretch  \">\n          <button\n            onClick={() => setmodal(!modal)}\n            className=\"flex flex-row justify-evenly text-white rounded-md bg-blue-500 w-52 p-4 text-2xl font-bold ml-24 mb-14 mt-10\"\n          >\n            <p>Nuevo</p>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-8 w-8 text-white\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 4v16m8-8H4\"\n              />\n            </svg>\n          </button>\n\n          <div className=\" container m-auto \">\n            <table className=\"m-auto bg-white\">\n              <thead className=\"  bg-blue-primary h-5 text-white\">\n                <tr>\n                  <th className=\" hidden sm:block \">Titulo</th>\n                  <th className=\"w-2/12 sm:w-4/12\">Nombre Del Paciente</th>\n                  <th className=\"w-1/12 sm:w-1/12\">Fecha</th>\n                  <th className=\"w-1/12 sm:w-1/12\">pdf</th>\n                  <th className=\"w-1/12 sm:w-1/12\">Eliminar</th>\n                  <th className=\"w-1/12 sm:w-1/12\">Qr</th>\n                </tr>\n              </thead>\n              <tbody className=\"text-center \">\n                {Documentos.length > 0 ?\n                  Documentos.map((element) => {\n                    return (\n                      <tr className=\"border-b  border-blue-primary\">\n                        <td className=\" hidden sm:block \">\n                          <a\n                            href={element.data().url}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {element.data().Titulo}\n                          </a>\n                        </td>\n                        <td>{element.data().Paciente}</td>\n                        <td>{element.data().fecha}</td>\n                        <td className=\"hover:bg-blue-primary hover:text-white\">\n                          <a\n                            className=\"flex flex-row m-auto\"\n                            href={element.data().url}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            <svg\n                              xmlns=\"http://www.w3.org/2000/svg\"\n                              className=\"h-8 w-8 m-auto\"  \n                              fill=\"none\"\n                              viewBox=\"0 0 24 24\"\n                              stroke=\"currentColor\"\n                            >\n                              <path\n                                strokeLinecap=\"round\"\n                                strokeLinejoin=\"round\"\n                                strokeWidth={2}\n                                d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                              />\n                            </svg>\n                          </a>\n                        </td>\n                        <td className=\"hover:bg-blue-primary hover:text-white\">\n                          <button onClick={() => eliminar(element.id)}>\n                            <DeleteButon />\n                          </button>\n                        </td>\n                        <td className=\"hover:bg-blue-primary hover:text-white\">\n                          <button onClick={() => QRmodal(element.data().url)}>\n                            <QrButon />\n                          </button>\n                        </td>\n                      </tr>\n                    );\n                  }):<div>Sin documentos </div>}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Main;\n"]},"metadata":{},"sourceType":"module"}