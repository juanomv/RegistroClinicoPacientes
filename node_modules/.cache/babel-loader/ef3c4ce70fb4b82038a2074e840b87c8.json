{"ast":null,"code":"import _regeneratorRuntime from\"/home/juano/reactProjects/Novo-Lab-Clinico/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/juano/reactProjects/Novo-Lab-Clinico/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/juano/reactProjects/Novo-Lab-Clinico/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Basura from\"../componets/Basura\";import PdfIcon from\"../componets/PdfIcon\";import QrIcon from\"../componets/QrIcon\";import EditIcon from\"../componets/EditIcon\";import Modal from\"../componets/Modal\";import AddRegistro from\"../componets/AddRegistro\";import{headers,Url}from'../config';import axios from'axios';import Moment from'moment';import SeccionCaducada from\"../componets/SeccionCaducada\";import Qrgenerato from\"../componets/QrGenerato\";import app from\"../firebase.config\";import{getStorage,ref,deleteObject}from\"firebase/storage\";import Descendente from\"../componets/Descendente\";import Ascendete from\"../componets/Ascendete\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function Registro(props){var storage=getStorage(app);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),AcitveModal=_useState2[0],setAcitveModal=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),session=_useState4[0],setsession=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),data=_useState6[0],setdata=_useState6[1];var _useState7=useState('Paciente'),_useState8=_slicedToArray(_useState7,2),tipeFind=_useState8[0],setTipeFind=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),size=_useState10[0],setsize=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),refresh=_useState12[0],setrefresh=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),modalQr=_useState14[0],setModalQr=_useState14[1];var _useState15=useState('desc'),_useState16=_slicedToArray(_useState15,2),order=_useState16[0],setOrder=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),Accion=_useState18[0],setAccion=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),edit=_useState20[0],setEdit=_useState20[1];headers.Authorization='Bearer '+localStorage.getItem('Token');useEffect(function(){axios.get(Url+\"Registro/Gets/\".concat(order),{headers:headers}).then(function(res){if(res.data.ok){setdata(res.data.data);}else{console.log(res.data);if(res.data.code==='CAD01')setsession(true);}}).catch(function(error){return console.log(error);});},[refresh]);function findPaciente(e){if(e.target.value.length>=size){setsize(e.target.value.length);var newdata=data.filter(function(element){var valor=element[tipeFind];valor=valor.toLowerCase();if(valor.indexOf(e.target.value.toLowerCase())>=0)return true;return false;});setdata(newdata);}else{setsize(e.target.value.length);setrefresh(!refresh);var _newdata=data.filter(function(element){var valor=element[tipeFind];valor=valor.toLowerCase();if(valor.indexOf(e.target.value.toLowerCase())>=0)return true;return false;});setdata(_newdata);}if(!e.target.value){setrefresh(!refresh);}}function ordeFecha(){if(order==='desc')setOrder('asc');else setOrder('desc');setrefresh(!refresh);}function handelSelect(e){setTipeFind(e.target.value);}function deleteRegister(_x,_x2){return _deleteRegister.apply(this,arguments);}function _deleteRegister(){_deleteRegister=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id,url){var res,desertRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.delete(Url+\"Registro/Delete/\".concat(id),{headers:headers});case 3:res=_context.sent;if(res.data.ok){desertRef=ref(storage,url);deleteObject(desertRef).then(function(){setrefresh(!refresh);}).catch(function(error){console.log(error);setrefresh(!refresh);});}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return _deleteRegister.apply(this,arguments);}function formatDate(date){Moment.locale('en');var fecha=new Date(date);return fecha.getDate(\"D\")+1+\" de \"+Moment(date).format('MMM YYYY');}function agregar(){setAcitveModal(true);setAccion('New');}function editar(valor){setAcitveModal(true);setAccion('Update');setEdit(valor);}return/*#__PURE__*/_jsxs(\"div\",{className:\"container  min-h-screen pb-24\",children:[session&&/*#__PURE__*/_jsx(SeccionCaducada,{}),modalQr&&/*#__PURE__*/_jsx(Modal,{cerrar:function cerrar(){return setModalQr(false);},titulo:'qr ',children:/*#__PURE__*/_jsx(Qrgenerato,{url:modalQr})}),AcitveModal&&/*#__PURE__*/_jsx(Modal,{cerrar:function cerrar(){return setAcitveModal(false);},titulo:'Agregar Paciente',children:/*#__PURE__*/_jsx(AddRegistro,{salir:function salir(){return setAcitveModal(!Modal);},reload:function reload(){setrefresh(!refresh);},accion:Accion,valores:edit})}),/*#__PURE__*/_jsx(\"button\",{onClick:agregar,className:\" m-4 bg-green-primary py-2 px-4 rounded-lg text-white text-lg\",children:\"+ Agregar Registro\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"p-3 mr-3  rounded-lg bg-blue-primary  text-center text-lg uppercase text-white focus:bg-white focus:text-blue-primary\",onChange:handelSelect,name:\"TipeFind\",id:\"tipefind\",defaultValue:'Paciente',children:[/*#__PURE__*/_jsx(\"option\",{value:\"Paciente\",children:\"Cedula\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Nombre\",children:\"Nombre Paciente\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ExaName\",children:\"Examen\"})]}),tipeFind===\"Paciente\"?/*#__PURE__*/_jsx(\"input\",{className:\"inputFind\",type:\"number\",name:\"find\",id:\"find\",pattern:\"[0-9]{10}\",onChange:findPaciente,placeholder:\"Buscar\"}):/*#__PURE__*/_jsx(\"input\",{className:\"inputFind\",type:\"text\",name:\"find\",id:\"find\",placeholder:\"Buscar\",onChange:findPaciente}),/*#__PURE__*/_jsxs(\"table\",{className:\"bg-white w-11/12 mx-auto mt-6 rounded-t-lg\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-blue-primary text-white rounded-t-lg\",children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-xl rounded-t-lg\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"rounded-tl-lg\",children:\"N\\xBA Cedula\"}),/*#__PURE__*/_jsx(\"th\",{className:\"\",children:\"Paciente\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Examen\"}),/*#__PURE__*/_jsxs(\"th\",{onClick:ordeFecha,className:\"cursor-pointer flex flex-row justify-center \",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Fecha\"}),\" \",order===\"desc\"?/*#__PURE__*/_jsx(Ascendete,{}):/*#__PURE__*/_jsx(Descendente,{}),\" \"]}),/*#__PURE__*/_jsx(\"th\",{className:\"w-10\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-10\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-10\"}),/*#__PURE__*/_jsx(\"th\",{className:\"rounded-tr-lg w-10 \"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"text-center\",children:data.map(function(element,i){var border='border-gray-300';var color='bg-white';if(i%2===0){color='bg-gray-400';border='border-white';}return/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-200 \",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 \".concat(color,\" \").concat(border,\" \"),children:element.Paciente}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 border-l \".concat(color,\" \").concat(border,\" \"),children:element.Nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 border-l \".concat(color,\" \").concat(border,\" \"),children:element.ExaName}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 w-auto border-l \".concat(color,\" \").concat(border,\" \"),children:formatDate(element.Fecha)}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 border-l \".concat(color,\" \").concat(border,\" \"),children:[/*#__PURE__*/_jsx(\"a\",{className:\"cursor-pointer\",href:\"\".concat(element.url),target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(PdfIcon,{})}),\" \"]}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return setModalQr(element.url);},className:\"py-2 border-l \".concat(color,\" \").concat(border,\" cursor-pointer\"),children:/*#__PURE__*/_jsx(QrIcon,{})}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return editar(element);},className:\"py-2 border-l cursor-pointer \".concat(color,\" \").concat(border,\" \"),children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){return deleteRegister(element.Id,element.url);},className:\"py-2 bg-red-500 cursor-pointer\",children:/*#__PURE__*/_jsx(Basura,{})})]});})})]})]});}","map":{"version":3,"sources":["/home/juano/reactProjects/Novo-Lab-Clinico/src/pages/Registro.jsx"],"names":["React","useState","useEffect","Basura","PdfIcon","QrIcon","EditIcon","Modal","AddRegistro","headers","Url","axios","Moment","SeccionCaducada","Qrgenerato","app","getStorage","ref","deleteObject","Descendente","Ascendete","Registro","props","storage","AcitveModal","setAcitveModal","session","setsession","data","setdata","tipeFind","setTipeFind","size","setsize","refresh","setrefresh","modalQr","setModalQr","order","setOrder","Accion","setAccion","edit","setEdit","Authorization","localStorage","getItem","get","then","res","ok","console","log","code","catch","error","findPaciente","e","target","value","length","newdata","filter","element","valor","toLowerCase","indexOf","ordeFecha","handelSelect","deleteRegister","id","url","delete","desertRef","formatDate","date","locale","fecha","Date","getDate","format","agregar","editar","map","i","border","color","Paciente","Nombre","ExaName","Fecha","Id"],"mappings":"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","sourcesContent":["import React, { useState ,useEffect } from \"react\";\nimport Basura from \"../componets/Basura\";\nimport PdfIcon from \"../componets/PdfIcon\";\nimport QrIcon from \"../componets/QrIcon\";\nimport EditIcon from \"../componets/EditIcon\"\nimport Modal from \"../componets/Modal\";\nimport AddRegistro from \"../componets/AddRegistro\";\nimport {headers,Url} from '../config';\nimport axios from 'axios';\nimport Moment from 'moment';\nimport SeccionCaducada from \"../componets/SeccionCaducada\";\nimport Qrgenerato from \"../componets/QrGenerato\";\nimport app from \"../firebase.config\";\nimport {\n  getStorage,\n  ref,\n  deleteObject,\n} from \"firebase/storage\";\n\nimport Descendente from \"../componets/Descendente\";\nimport Ascendete from \"../componets/Ascendete\";\nexport function Registro(props) {\n  const storage = getStorage(app)\n  const [AcitveModal,setAcitveModal] = useState(false);\n  const [session,setsession] = useState(false);\n  const [data,setdata] = useState([]);\n  \n  const [tipeFind,setTipeFind] = useState('Paciente');\n  const [size,setsize] = useState(0);\n  const [refresh,setrefresh] = useState(false);\n  const [modalQr,setModalQr]  = useState(null);\n  const [order,setOrder] = useState('desc')\n  const [Accion, setAccion] = useState(null)\n  const [edit, setEdit] = useState(null)\n    headers.Authorization = 'Bearer ' + localStorage.getItem('Token')\n    useEffect(() => {\n     \n      axios.get(Url+`Registro/Gets/${order}`,{headers}).then(res=>{\n        if(res.data.ok){setdata(res.data.data)}\n        else{\n          console.log(res.data)\n          if(res.data.code==='CAD01') setsession(true)\n        }\n      }).catch(error=>console.log(error))\n      \n    }, [refresh])\n\n    function findPaciente(e){\n      \n      if((e.target.value).length>=size){\n        setsize((e.target.value).length)\n        let newdata=data.filter((element)=>{\n        let valor =element[tipeFind]\n        valor= valor.toLowerCase()\n        if(valor.indexOf((e.target.value).toLowerCase())>=0) return true\n        return false\n      })\n      setdata(newdata)\n    }else{\n      setsize((e.target.value).length)\n      setrefresh(!refresh)\n      let newdata=data.filter((element)=>{\n        let valor =element[tipeFind]\n      valor= valor.toLowerCase()\n      if(valor.indexOf((e.target.value).toLowerCase())>=0) return true\n      return false\n    })\n    setdata(newdata)\n    }\n     \n    if(!e.target.value){setrefresh(!refresh)}\n    }\n    function ordeFecha(){\n      if(order==='desc') setOrder('asc')\n      else setOrder('desc')\n      setrefresh(!refresh)\n    }\n    function handelSelect(e){\n      setTipeFind(e.target.value)\n    }\n    \n    async function deleteRegister(id,url){\n      try {\n        const res= await axios.delete(Url+`Registro/Delete/${id}`,{headers})\n        if(res.data.ok) {\n\n          const desertRef = ref(storage, url);\n          deleteObject(desertRef)\n            .then(() => {\n              setrefresh(!refresh)\n              \n            })\n            .catch((error) => {\n              console.log(error);\n             \n              setrefresh(!refresh)\n            });  \n          \n        }\n\n      } catch (error) {\n        console.log(error)\n      }\n    }\n    function formatDate(date){\n      Moment.locale('en');\n        const fecha = new Date(date)\n        return(fecha.getDate(\"D\")+1+\" de \"+Moment(date).format('MMM YYYY'))\n    }\n    function agregar() {\n      setAcitveModal(true)\n      setAccion('New')\n    }\n    function editar(valor) {\n      setAcitveModal(true)\n      setAccion('Update')\n      setEdit(valor)\n    }\n  return (\n    <div className=\"container  min-h-screen pb-24\">\n      {session&&<SeccionCaducada/>} \n      {modalQr&&<Modal cerrar={()=>setModalQr(false) } titulo={'qr '}><Qrgenerato url={modalQr}/></Modal>}\n      {AcitveModal&&<Modal cerrar={()=>setAcitveModal(false) } titulo={'Agregar Paciente'}><AddRegistro salir={()=>setAcitveModal(!Modal)}  reload={()=>{setrefresh(!refresh)}} accion={Accion} valores={edit}/></Modal>}\n      <button onClick={agregar} className=\" m-4 bg-green-primary py-2 px-4 rounded-lg text-white text-lg\">\n        \n        + Agregar Registro\n      </button>\n      <select className=\"p-3 mr-3  rounded-lg bg-blue-primary  text-center text-lg uppercase text-white focus:bg-white focus:text-blue-primary\" onChange={handelSelect} name=\"TipeFind\" id=\"tipefind\" defaultValue={'Paciente'}>\n        <option value=\"Paciente\" >Cedula</option>\n        <option value=\"Nombre\" >Nombre Paciente</option>\n        <option value=\"ExaName\" >Examen</option>\n      </select>\n     \n      {tipeFind===\"Paciente\"?<input className=\"inputFind\" type=\"number\" name=\"find\" id=\"find\" pattern='[0-9]{10}' onChange={findPaciente} placeholder=\"Buscar\"/>\n      :<input className=\"inputFind\" type=\"text\" name=\"find\" id=\"find\" placeholder=\"Buscar\" onChange={findPaciente}/>\n      }\n      \n      <table className=\"bg-white w-11/12 mx-auto mt-6 rounded-t-lg\">\n        <thead className=\"bg-blue-primary text-white rounded-t-lg\">\n          <tr className=\"text-xl rounded-t-lg\">\n            <th className=\"rounded-tl-lg\">NÂº Cedula</th>\n            <th className=\"\">Paciente</th>\n            <th >Examen</th>\n            <th onClick={ordeFecha} className=\"cursor-pointer flex flex-row justify-center \"><div>Fecha</div> {order===\"desc\"?<Ascendete/>:<Descendente/>} </th>\n            <th className=\"w-10\"></th>\n            <th className=\"w-10\"></th>\n            <th className=\"w-10\"></th>\n            <th className=\"rounded-tr-lg w-10 \"></th>\n          </tr>\n        </thead>\n        \n        <tbody className=\"text-center\">\n          {data.map((element, i) => {\n            let border = 'border-gray-300'\n            let color ='bg-white'\n            if (i % 2 === 0) {color = 'bg-gray-400'; border='border-white'} \n            return (\n              <tr className=\"bg-gray-200 \">\n                <td className={`py-2 ${color} ${border} `}>{element.Paciente}</td>\n                <td className={`py-2 border-l ${color} ${border} `}>{element.Nombre}</td>\n                <td className={`py-2 border-l ${color} ${border} `}>{element.ExaName}</td>\n                <td className={`py-2 w-auto border-l ${color} ${border} `}>{formatDate(element.Fecha)}</td>\n                <td className={`py-2 border-l ${color} ${border} `}><a className=\"cursor-pointer\" href={`${element.url}`} target=\"_blank\" rel=\"noopener noreferrer\"><PdfIcon/></a> </td>\n                <td onClick={()=>setModalQr(element.url)} className={`py-2 border-l ${color} ${border} cursor-pointer`}>{<QrIcon/>}</td>\n                <td onClick={()=>editar(element)} className={`py-2 border-l cursor-pointer ${color} ${border} `}>{<EditIcon/>}</td>\n                <td onClick={()=>deleteRegister(element.Id,element.url)} className=\"py-2 bg-red-500 cursor-pointer\">{<Basura/>}</td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}