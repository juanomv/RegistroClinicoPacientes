{"ast":null,"code":"var _jsxFileName = \"/home/juano/reactProjects/qr_guillo (copia)/src/componets/AddRegistro.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Select from \"react-select\";\nimport axios from \"axios\";\nimport app from \"../firebase.config\";\nimport { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from \"firebase/storage\";\nimport { headers, Url as lru } from \"../config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AddRegistro = () => {\n  _s();\n\n  const storage = getStorage(app);\n  const [pacientes, setPacientes] = useState([]);\n  const [examenes, setExamenes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  headers.Authorization = \"Bearer \" + localStorage.getItem(\"Token\");\n  useEffect(() => {\n    axios.get(lru + \"Registro/GetAll\", {\n      headers\n    }).then(res => {\n      setPacientes(res.data.Paciente);\n      setExamenes(res.data.Examen);\n    }).catch(error => console.log(error));\n  }, []);\n  const [data, setData] = useState({\n    Examen: null,\n    Paciente: null,\n    Url: null,\n    Fecha: null\n  });\n  const [file, setFile] = useState(null);\n  const [errorExamen, setErrorExamen] = useState(null);\n  const [errorPaciente, setErrorPaciente] = useState(null);\n  const [errorUrl, setErrorUrl] = useState(null);\n  const [errorFecha, setErrorFecha] = useState(null);\n\n  const handleChange = e => {\n    e.preventDefault();\n\n    if (data.Url) {\n      let archivo = data.Url.split(\"%2F\")[1].split(\"?\")[0].replaceAll(\"%20\", \" \");\n      const desertRef = ref(storage, `documentos/${archivo}`);\n      deleteObject(desertRef).then(() => {\n        data.Url = null;\n        setData(data);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n\n    console.log(e.target.files[0]);\n    if (e.target.files[0]) setFile(e.target.files[0]);else setFile(null);\n    setErrorUrl(null);\n  };\n\n  const addRegistro = async () => {\n    if (!data.Paciente) setErrorPaciente(\"el Paciente es obligatorio\");\n    if (!data.Examen) setErrorExamen(\"el Examen obligatorio\");\n    if (!data.Fecha) setErrorFecha(\"Fecha obligatorio\");\n    if (!file) setErrorUrl(\"Debe subir un Documento\");\n\n    if (file && !data.Url) {\n      const minuto = new Date().getMinutes();\n      const seconds = new Date().getMilliseconds();\n      const sec = new Date().getSeconds();\n      const archivo = ref(storage, `documentos/${file.name.split(\".pdf\")[0]}-${seconds}-${minuto}-${sec}.pdf`);\n      await uploadBytes(archivo, file);\n      const res = await getDownloadURL(archivo);\n      data.Url = res;\n      setData(data);\n    }\n\n    console.log(\"data\", data);\n    console.log(`url : ${data.Url}`);\n    let subir = true;\n\n    for (const key in data) {\n      if (!data[key]) subir = false;\n    }\n\n    if (subir) {\n      const res = await axios.post(lru + 'Registro/New', data, {\n        headers\n      });\n      console.log(res.data);\n    }\n  };\n\n  const handleChangeD = param => e => {\n    if (param !== \"Fecha\") data[param] = e.value;else data[param] = e.target.value;\n    setData(data);\n\n    switch (param) {\n      case \"Paciente\":\n        setErrorPaciente(null);\n        break;\n\n      case \"Examen\":\n        setErrorExamen(null);\n        break;\n\n      case \"Fecha\":\n        setErrorFecha(null);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"flex flex-col bg-white w-auto p-4 justify-between\",\n    children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \" flex flex-col justify-center items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"animate-spin rounded-full h-32 w-32 border-b-4 border-blue-900\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute\",\n        children: \"Cargando..\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 3\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 18\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"mt-4 mb-1\",\n      htmlFor: \"Paciente\",\n      children: \"Paciente\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Select, {\n      id: \"Paciente\",\n      options: pacientes,\n      onChange: handleChangeD(\"Paciente\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"Warring\",\n      children: errorPaciente && errorPaciente\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"mt-4 mb-1\",\n      htmlFor: \"Examen\",\n      children: \"Examen\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Select, {\n      id: \"Examen\",\n      className: \"w-96\",\n      options: examenes,\n      onChange: handleChangeD(\"Examen\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"Warring\",\n      children: errorExamen && errorExamen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"mt-4 mb-1\",\n      htmlFor: \"Archivo\",\n      children: \"Subir Pdf\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      onChange: handleChange,\n      type: \"file\",\n      name: \"Archivo\",\n      id: \"Archivo\",\n      accept: \"application/pdf \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"Warring\",\n      children: errorUrl && errorUrl\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"mt-4 mb-1\",\n      htmlFor: \"Fecha\",\n      children: \"Fecha\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"date\",\n      name: \"Fecha\",\n      id: \"Fecha\",\n      onChange: handleChangeD(\"Fecha\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"Warring\",\n      children: errorFecha && errorFecha\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      onClick: () => addRegistro(),\n      className: \"w-2/3 my-6 ml-16\",\n      type: \"button\",\n      value: \"Agregar\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddRegistro, \"B877bXXYazB/pqgyVCKAxc5/hsE=\");\n\n_c = AddRegistro;\nexport default AddRegistro;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddRegistro\");","map":{"version":3,"sources":["/home/juano/reactProjects/qr_guillo (copia)/src/componets/AddRegistro.jsx"],"names":["React","useEffect","useState","Select","axios","app","getStorage","ref","uploadBytes","getDownloadURL","deleteObject","headers","Url","lru","AddRegistro","storage","pacientes","setPacientes","examenes","setExamenes","loading","setLoading","Authorization","localStorage","getItem","get","then","res","data","Paciente","Examen","catch","error","console","log","setData","Fecha","file","setFile","errorExamen","setErrorExamen","errorPaciente","setErrorPaciente","errorUrl","setErrorUrl","errorFecha","setErrorFecha","handleChange","e","preventDefault","archivo","split","replaceAll","desertRef","target","files","addRegistro","minuto","Date","getMinutes","seconds","getMilliseconds","sec","getSeconds","name","subir","key","post","handleChangeD","param","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Select from \"react-select\";\nimport axios from \"axios\";\nimport app from \"../firebase.config\";\nimport {\n  getStorage,\n  ref,\n  uploadBytes,\n  getDownloadURL,\n  deleteObject,\n} from \"firebase/storage\";\nimport { headers, Url as lru } from \"../config\";\n\nconst AddRegistro = () => {\n  const storage = getStorage(app);\n  const [pacientes, setPacientes] = useState([]);\n  const [examenes, setExamenes] = useState([]);\n  const [loading,setLoading]=useState(true)\n  headers.Authorization = \"Bearer \" + localStorage.getItem(\"Token\");\n  useEffect(() => {\n    \n    axios\n      .get(lru + \"Registro/GetAll\", { headers })\n      .then((res) => {\n        setPacientes(res.data.Paciente);\n        setExamenes(res.data.Examen);\n      })\n      .catch((error) => console.log(error));\n  }, []);\n\n  const [data, setData] = useState({\n    Examen: null,\n    Paciente: null,\n    Url: null,\n    Fecha: null,\n  });\n  const [file, setFile] = useState(null);\n  const [errorExamen, setErrorExamen] = useState(null);\n  const [errorPaciente, setErrorPaciente] = useState(null);\n  const [errorUrl, setErrorUrl] = useState(null);\n  const [errorFecha, setErrorFecha] = useState(null);\n\n  const handleChange = (e) => {\n    e.preventDefault();\n    if (data.Url) {\n      let archivo = data.Url.split(\"%2F\")[1]\n        .split(\"?\")[0]\n        .replaceAll(\"%20\", \" \");\n      const desertRef = ref(storage, `documentos/${archivo}`);\n      deleteObject(desertRef)\n        .then(() => {\n          data.Url = null;\n          setData(data);\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n    console.log(e.target.files[0])\n    if(e.target.files[0]) setFile(e.target.files[0]);\n    else setFile(null)\n    setErrorUrl(null)\n  };\n\n  const addRegistro = async () => {\n    if (!data.Paciente) setErrorPaciente(\"el Paciente es obligatorio\");\n    if (!data.Examen) setErrorExamen(\"el Examen obligatorio\");\n    if (!data.Fecha) setErrorFecha(\"Fecha obligatorio\");\n    if (!file) setErrorUrl(\"Debe subir un Documento\");\n    \n    if (file && !data.Url) {\n      const minuto = new Date().getMinutes();\n      const seconds = new Date().getMilliseconds();\n      const sec = new Date().getSeconds();\n      const archivo = ref(\n        storage,\n        `documentos/${\n          file.name.split(\".pdf\")[0]\n        }-${seconds}-${minuto}-${sec}.pdf`\n      );\n      await uploadBytes(archivo, file);\n      const res = await getDownloadURL(archivo);\n      data.Url = res;\n      setData(data);\n    }\n\n\n    console.log(\"data\", data);\n    console.log(`url : ${data.Url}`);\n    let subir = true\n    for (const key in data) {\n      if(!data[key]) subir=false\n    }\n    if(subir) {\n      const res = await axios.post(lru+'Registro/New',data,{headers})\n      console.log(res.data)\n    }\n  };\n\n  const handleChangeD = (param) => (e) => {\n    if (param !== \"Fecha\") data[param] = e.value;\n    else data[param] = e.target.value;\n    setData(data);\n    switch (param) {\n      case \"Paciente\":\n        setErrorPaciente(null);\n        break;\n      case \"Examen\":\n        setErrorExamen(null);\n        break;\n      case \"Fecha\":\n        setErrorFecha(null);\n        break;\n      default:\n        break;\n    }\n  };\n  return (\n    \n    <form className=\"flex flex-col bg-white w-auto p-4 justify-between\">\n      {loading&& <div class=\" flex flex-col justify-center items-center\">\n  <div class=\"animate-spin rounded-full h-32 w-32 border-b-4 border-blue-900\">\n  </div>\n  <div className=\"absolute\" >Cargando..</div>\n</div>\n}\n      <label className=\"mt-4 mb-1\" htmlFor=\"Paciente\">\n        Paciente\n      </label>\n      <Select\n        id=\"Paciente\"\n        options={pacientes}\n        onChange={handleChangeD(\"Paciente\")}\n      />\n      <span className=\"Warring\">{errorPaciente && errorPaciente}</span>\n\n      <label className=\"mt-4 mb-1\" htmlFor=\"Examen\">\n        Examen\n      </label>\n      <Select\n        id=\"Examen\"\n        className=\"w-96\"\n        options={examenes}\n        onChange={handleChangeD(\"Examen\")}\n      />\n      <span className=\"Warring\">{errorExamen && errorExamen}</span>\n      <label className=\"mt-4 mb-1\" htmlFor=\"Archivo\">\n        Subir Pdf\n      </label>\n      <input\n        onChange={handleChange}\n        type=\"file\"\n        name=\"Archivo\"\n        id=\"Archivo\"\n        accept=\"application/pdf \"\n      />\n      <span className=\"Warring\">{errorUrl && errorUrl}</span>\n      <label className=\"mt-4 mb-1\" htmlFor=\"Fecha\">\n        Fecha\n      </label>\n      <input\n        type=\"date\"\n        name=\"Fecha\"\n        id=\"Fecha\"\n        onChange={handleChangeD(\"Fecha\")}\n      />\n      <span className=\"Warring\">{errorFecha && errorFecha}</span>\n      <input\n        onClick={() => addRegistro()}\n        className=\"w-2/3 my-6 ml-16\"\n        type=\"button\"\n        value=\"Agregar\"\n      />\n    </form>\n  );\n};\n\nexport default AddRegistro;\n"]},"metadata":{},"sourceType":"module"}